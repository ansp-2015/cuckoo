{% load i18n %}
<section id="summary">
    <h4><span class="glyphicon glyphicon-list-alt" aria-hidden="true"></span> {% trans "Summary" %}</h4>
    <div class="tabbable tabs">
        <ul class="nav nav-pills" style="margin-bottom: 0;">
            <li class="active"><a href="#summary_files" data-toggle="tab">{% trans "Files" %}</a></li>
            <li><a href="#summary_keys" data-toggle="tab">{% trans "Registry" %}</a></li>
            <li><a href="#summary_mutexes" data-toggle="tab">{% trans "Mutexes" %}</a></li>
            <li><a href="#summary_directories" data-toggle="tab">{% trans "Directories" %}</a></li>
            <li><a href="#summary_processes" data-toggle="tab">{% trans "Processes" %}</a></li>
        </ul>
        <div class="tab-content">
            <div class="tab-pane fade in active" id="summary_files">
                {% for process in analysis.behavior.generic %}
                    {% if process.summary %}
                    <div class="panel panel-default">
                        <div class="panel-heading"><h3 class="panel-title">
                            {% blocktrans with name=process.process_name pid=process.pid trimmed %}
                            Process {{name}} ({{pid}})
                            {% endblocktrans %}
                        </h3></div>
                        <ul class="list-group">
                        {% if process.summary.file_opened %}
                            <li class="list-group-item">
                                <p><b>{% trans "Opened files" %}</b></p>
                                <ul>
                                {% for entry in process.summary.file_opened %}
                                    <li>{{entry}}</li>
                                {% endfor %}
                                </ul>
                            </li>
                        {% endif %}

                        {% if process.summary.file_written %}
                            <li class="list-group-item">
                                <p><b>{% trans "Written files" %}</b></p>
                                <ul>
                                {% for entry in process.summary.file_written %}
                                    <li>{{entry}}</li>
                                {% endfor %}
                                </ul>
                            </li>
                        {% endif %}

                        {% if process.summary.file_read %}
                            <li class="list-group-item">
                                <p><b>{% trans "Files Read" %}</b></p>
                                <ul>
                                {% for entry in process.summary.file_read %}
                                    <li>{{entry}}</li>
                                {% endfor %}
                                </ul>
                            </li>
                        {% endif %}
                        </ul>
                    </div>
                    {% endif %}
                {% endfor %}
            </div>
            <div class="tab-pane fade" id="summary_keys">
                {% for process in analysis.behavior.generic %}
                    {% if process.summary %}
                    <div class="panel panel-default">
                        <div class="panel-heading"><h3 class="panel-title">
                            {% blocktrans with name=process.process_name pid=process.pid trimmed %}
                            Process {{name}} ({{pid}})
                            {% endblocktrans %}
                        </h3></div>
                        <ul class="list-group">
                        {% if process.summary.regkey_opened %}
                            <li class="list-group-item">
                                <p><b>{% trans "Registry keys opened" %}</b></p>
                                <ul>
                                {% for entry in process.summary.regkey_opened %}
                                    <li>{{entry}}</li>
                                {% endfor %}
                                </ul>
                            </li>
                        {% endif %}

                        {% if process.summary.regkey_written %}
                            <li class="list-group-item">
                                <p><b>{% trans "Registry keys written" %}</b></p>
                                <ul>
                                {% for entry in process.summary.regkey_written %}
                                    <li>{{entry}}</li>
                                {% endfor %}
                                </ul>
                            </li>
                        {% endif %}

                        {% if process.summary.regkey_read %}
                            <li class="list-group-item">
                                <p><b>{% trans "Registry keys read" %}</b></p>
                                <ul>
                                {% for entry in process.summary.regkey_read %}
                                    <li>{{entry}}</li>
                                {% endfor %}
                                </ul>
                            </li>
                        {% endif %}
                        </ul>
                    </div>
                    {% endif %}
                {% endfor %}
            </div>
            <div class="tab-pane fade" id="summary_mutexes">
                {% for process in analysis.behavior.generic %}
                    {% if process.summary %}
                    <div class="panel panel-default">
                        <div class="panel-heading"><h3 class="panel-title">
                            {% blocktrans with name=process.process_name pid=process.pid trimmed %}
                            Process {{name}} ({{pid}})
                            {% endblocktrans %}
                        </h3></div>
                        <ul class="list-group">
                        {% if process.summary.mutex %}
                            <li class="list-group-item">
                                <p><b>{% trans "Mutexes accessed" %}</b></p>
                                <ul>
                                {% for entry in process.summary.mutex %}
                                    <li>{{entry}}</li>
                                {% endfor %}
                                </ul>
                            </li>
                        {% endif %}
                        </ul>
                    </div>
                    {% endif %}
                {% endfor %}
            </div>
            <div class="tab-pane fade" id="summary_directories">
                {% for process in analysis.behavior.generic %}
                    {% if process.summary %}
                    <div class="panel panel-default">
                        <div class="panel-heading"><h3 class="panel-title">
                            {% blocktrans with name=process.process_name pid=process.pid trimmed %}
                            Process {{name}} ({{pid}})
                            {% endblocktrans %}
                        </h3></div>
                        <ul class="list-group">
                        {% if process.summary.directory_created %}
                            <li class="list-group-item">
                                <p><b>{% trans "Directories created" %}</b></p>
                                <ul>
                                {% for entry in process.summary.directory_created %}
                                    <li>{{entry}}</li>
                                {% endfor %}
                                </ul>
                            </li>
                        {% endif %}

                        {% if process.summary.directory_removed %}
                            <li class="list-group-item">
                                <p><b>{% trans "Directories removed" %}</b></p>
                                <ul>
                                {% for entry in process.summary.directory_removed %}
                                    <li>{{entry}}</li>
                                {% endfor %}
                                </ul>
                            </li>
                        {% endif %}

                        {% if process.summary.directory_enumerated %}
                            <li class="list-group-item">
                                <p><b>{% trans "Directories enumerated" %}</b></p>
                                <ul>
                                {% for entry in process.summary.directory_enumerated %}
                                    <li>{{entry}}</li>
                                {% endfor %}
                                </ul>
                            </li>
                        {% endif %}
                        </ul>
                    </div>
                    {% endif %}
                {% endfor %}
            </div>
            <div class="tab-pane fade" id="summary_processes">
                {% for process in analysis.behavior.generic %}
                    {% if process.summary %}
                    <div class="panel panel-default">
                        <div class="panel-heading"><h3 class="panel-title">
                            {% blocktrans with name=process.process_name pid=process.pid trimmed %}
                            Process {{name}} ({{pid}})
                            {% endblocktrans %}
                        </h3></div>
                        <ul class="list-group">
                        {% if process.summary.command_line %}
                            <li class="list-group-item">
                                <p><b>{% trans "Processes created" %}</b></p>
                                <ul>
                                {% for entry in process.summary.command_line %}
                                    <li>{{entry}}</li>
                                {% endfor %}
                                </ul>
                            </li>
                        {% endif %}

                        {% if process.summary.dll_loaded %}
                            <li class="list-group-item">
                                <p><b>{% trans "DLLs Loaded" %}</b></p>
                                <ul>
                                {% for entry in process.summary.dll_loaded %}
                                    <li>{{entry}}</li>
                                {% endfor %}
                                </ul>
                            </li>
                        {% endif %}
                        </ul>
                    </div>
                    {% endif %}
                {% endfor %}
            </div>
        </div>
    </div>
</section>
